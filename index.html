<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <title>我的购物车-品优购</title>
  <meta name="description"
    content="品优购JD.COM-专业的综合网上购物商城,销售家电、数码通讯、电脑、家居百货、服装服饰、母婴、图书、食品等数万个品牌优质商品.便捷、诚信的服务，为您提供愉悦的网上购物体验!" />
  <meta name="Keywords" content="网上购物,网上商城,手机,笔记本,电脑,MP3,CD,VCD,DV,相机,数码,配件,手表,存储卡,品优购" />
  <!-- 引入facicon.ico网页图标 -->
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
  <!-- 引入css 初始化的css 文件 -->
  <link rel="stylesheet" href="css/base.css">
  <!-- 引入公共样式的css 文件 -->
  <link rel="stylesheet" href="css/common.css">
  <!-- 引入car css -->
  <link rel="stylesheet" href="css/car.css">
  <style>
    /* input设置type="number"求掉上下箭头  */
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
      -webkit-appearance: none !important;
    }

    input[type='number'] {
      -moz-appearance: textfield !important;
    }
  </style>
</head>

<body>
  <!-- <input type="text" id="ipt"> -->
  <!-- 顶部快捷导航start -->
  <div class="shortcut">
    <div class="w">
      <div class="fl">
        <ul>
          <li>品优购欢迎您！ </li>
          <li>
            <a href="#">请登录</a>
            <a href="#" class="style-red">免费注册</a>
          </li>
        </ul>
      </div>
      <div class="fr">
        <ul>
          <li><a href="#">我的订单</a></li>
          <li class="spacer"></li>
          <li>
            <a href="#">我的品优购</a>
            <i class="icomoon"></i>
          </li>
          <li class="spacer"></li>
          <li><a href="#">品优购会员</a></li>
          <li class="spacer"></li>
          <li><a href="#">企业采购</a></li>
          <li class="spacer"></li>
          <li><a href="#">关注品优购</a> <i class="icomoon"></i></li>
          <li class="spacer"></li>
          <li><a href="#">客户服务</a> <i class="icomoon"></i></li>
          <li class="spacer"></li>
          <li><a href="#">网站导航</a> <i class="icomoon"></i></li>
        </ul>
      </div>
    </div>
  </div>
  <!-- 顶部快捷导航end  -->


  <div class="car-header">
    <div class="w">
      <div class="car-logo">
        <img src="img/logo.png" alt=""> <b>购物车</b>
      </div>
    </div>
  </div>

  <div class="c-container">
    <div class="w">
      <div class="cart-filter-bar">
        <em>全部商品</em>
      </div>
      <!-- 购物车主要核心区域 -->
      <div class="cart-warp">
        <!-- 头部全选模块 -->
        <div class="cart-thead">
          <div class="t-checkbox">
            <input type="checkbox" name="" id="" class="checkall"> 全选
          </div>
          <div class="t-goods">商品</div>
          <div class="t-price">单价</div>
          <div class="t-num">数量</div>
          <div class="t-sum">小计</div>
          <div class="t-action">操作</div>
        </div>

        <!-- 商品详细模块 -->
        <div class="cart-item-list">
          <div class="cart-item check-cart-item">
            <div class="p-checkbox">
              <input type="checkbox" name="" id="" class="j-checkbox">
            </div>
            <div class="p-goods">
              <div class="p-img">
                <img src="upload/p1.jpg" alt="">
              </div>
              <div class="p-msg">【5本26.8元】经典儿童文学彩图青少版八十天环游地球中学生语文教学大纲</div>
            </div>
            <div class="p-price">￥12.60</div>
            <div class="p-num">
              <div class="quantity-form">
                <a href="javascript:;" class="decrement">-</a>
                <input type="number" class="itxt" value="1">
                <a href="javascript:;" class="increment">+</a>
              </div>
            </div>
            <div class="p-sum">￥12.60</div>
            <div class="p-action"><a href="javascript:;">删除</a></div>
          </div>
          <div class="cart-item">
            <div class="p-checkbox">
              <input type="checkbox" name="" id="" class="j-checkbox">
            </div>
            <div class="p-goods">
              <div class="p-img">
                <img src="upload/p2.jpg" alt="">
              </div>
              <div class="p-msg">【2000张贴纸】贴纸书 3-6岁 贴画儿童 贴画书全套12册 贴画 贴纸儿童 汽</div>
            </div>
            <div class="p-price">￥24.80</div>
            <div class="p-num">
              <div class="quantity-form">
                <a href="javascript:;" class="decrement">-</a>
                <input type="number" class="itxt" value="1">
                <a href="javascript:;" class="increment">+</a>
              </div>
            </div>
            <div class="p-sum">￥24.80</div>
            <div class="p-action"><a href="javascript:;">删除</a></div>
          </div>
          <div class="cart-item">
            <div class="p-checkbox">
              <input type="checkbox" name="" id="" class="j-checkbox">
            </div>
            <div class="p-goods">
              <div class="p-img">
                <img src="upload/p3.jpg" alt="">
              </div>
              <div class="p-msg">唐诗三百首+成语故事全2册 一年级课外书 精装注音儿童版 小学生二三年级课外阅读书籍</div>
            </div>
            <div class="p-price">￥29.80</div>
            <div class="p-num">
              <div class="quantity-form">
                <a href="javascript:;" class="decrement">-</a>
                <input type="number" class="itxt" value="1">
                <a href="javascript:;" class="increment">+</a>
              </div>
            </div>
            <div class="p-sum">￥29.80</div>
            <div class="p-action"><a href="javascript:;">删除</a></div>
          </div>
        </div>

        <!-- 结算模块 -->
        <div class="cart-floatbar">
          <div class="operation">
            <a href="javascript:;" class="remove-batch"> 删除选中的商品</a>
            <a href="javascript:;" class="clear-all">清理购物车</a>
          </div>
          <div class="toolbar-right">
            <div class="amount-sum">已经选<em>0</em>件商品</div>
            <div class="price-sum">总价： <em>0.00</em></div>
            <div class="btn-area">去结算</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- footer start -->
  <div class="footer">
    <div class="w">
      <!-- mod_service -->
      <div class="mod_service">
        <ul>
          <li>
            <i class="mod-service-icon mod_service_zheng"></i>
            <div class="mod_service_tit">
              <h5>正品保障</h5>
              <p>正品保障，提供发票</p>
            </div>
          </li>
          <li>
            <i class="mod-service-icon mod_service_kuai"></i>
            <div class="mod_service_tit">
              <h5>正品保障</h5>
              <p>正品保障，提供发票</p>
            </div>
          </li>
          <li>
            <i class="mod-service-icon mod_service_bao"></i>
            <div class="mod_service_tit">
              <h5>正品保障</h5>
              <p>正品保障，提供发票</p>
            </div>
          </li>
          <li>
            <i class="mod-service-icon mod_service_bao"></i>
            <div class="mod_service_tit">
              <h5>正品保障</h5>
              <p>正品保障，提供发票</p>
            </div>
          </li>
          <li>
            <i class="mod-service-icon mod_service_bao"></i>
            <div class="mod_service_tit">
              <h5>正品保障</h5>
              <p>正品保障，提供发票</p>
            </div>
          </li>
        </ul>
      </div>
      <!-- mod_help -->
      <div class="mod_help">
        <dl class="mod_help_item">
          <dt>购物指南</dt>
          <dd> <a href="#">购物流程 </a></dd>
          <dd> <a href="#">会员介绍 </a></dd>
          <dd> <a href="#">生活旅行/团购 </a></dd>
          <dd> <a href="#">常见问题 </a></dd>
          <dd> <a href="#">大家电 </a></dd>
          <dd> <a href="#">联系客服 </a></dd>
        </dl>
        <dl class="mod_help_item">
          <dt>购物指南</dt>
          <dd> <a href="#">购物流程 </a></dd>
          <dd> <a href="#">会员介绍 </a></dd>
          <dd> <a href="#">生活旅行/团购 </a></dd>
          <dd> <a href="#">常见问题 </a></dd>
          <dd> <a href="#">大家电 </a></dd>
          <dd> <a href="#">联系客服 </a></dd>
        </dl>
        <dl class="mod_help_item">
          <dt>购物指南</dt>
          <dd> <a href="#">购物流程 </a></dd>
          <dd> <a href="#">会员介绍 </a></dd>
          <dd> <a href="#">生活旅行/团购 </a></dd>
          <dd> <a href="#">常见问题 </a></dd>
          <dd> <a href="#">大家电 </a></dd>
          <dd> <a href="#">联系客服 </a></dd>
        </dl>
        <dl class="mod_help_item">
          <dt>购物指南</dt>
          <dd> <a href="#">购物流程 </a></dd>
          <dd> <a href="#">会员介绍 </a></dd>
          <dd> <a href="#">生活旅行/团购 </a></dd>
          <dd> <a href="#">常见问题 </a></dd>
          <dd> <a href="#">大家电 </a></dd>
          <dd> <a href="#">联系客服 </a></dd>
        </dl>
        <dl class="mod_help_item">
          <dt>购物指南</dt>
          <dd> <a href="#">购物流程 </a></dd>
          <dd> <a href="#">会员介绍 </a></dd>
          <dd> <a href="#">生活旅行/团购 </a></dd>
          <dd> <a href="#">常见问题 </a></dd>
          <dd> <a href="#">大家电 </a></dd>
          <dd> <a href="#">联系客服 </a></dd>
        </dl>
        <dl class="mod_help_item mod_help_app">
          <dt>帮助中心</dt>
          <dd>
            <img src="upload/erweima.png" alt="">
            <p>品优购客户端</p>
          </dd>
        </dl>
      </div>

      <!-- mod_copyright  -->
      <div class="mod_copyright">
        <p class="mod_copyright_links">
          关于我们 | 联系我们 | 联系客服 | 商家入驻 | 营销中心 | 手机品优购 | 友情链接 | 销售联盟 | 品优购社区 | 品优购公益 | English Site | Contact U
        </p>
        <p class="mod_copyright_info">
          地址：北京市昌平区建材城西路金燕龙办公楼一层 邮编：100096 电话：400-618-4000 传真：010-82935100 邮箱: zhanghj+itcast.cn <br>
          京ICP备08001421号京公网安备110108007702
        </p>
      </div>
    </div>
  </div>

  <!-- footer end -->
  <script src="./js/jquery.min.js"></script>
  <script>
    $(function () {
      // 1.全选框 - 小选
      // 1.1全选框 - 注册点击事件
      // 1.2找到所有的小选框 -将全选框的状态 赋予给我们的小选框
      $('.checkall').on('click', function () {
        // console.log($('.checkall').prop('checked'));
        // console.log($('.checkall').attr('checked')); attr获取不到 这个checked 固有属性
        $('.j-checkbox').prop('checked', $('.checkall').prop('checked'))
        totalNum()
        getBgc()
      })


      // 2，选中小的控制总开关        
      $('.j-checkbox').on('click', function () {
        // console.log(22);
        // console.log($('.j-checkbox'));
        // console.log(Array.from($('.j-checkbox')));

        // let result = Array.from($('.j-checkbox')).every(function (item, index) {
        //   // console.log(item);
        //   // console.log($(item));
        //   // console.log($(item).prop('checked'));
        //   return $(item).prop('checked') === true
        // })
        // 判断小选框的长度 是否等于选中小选框的长度，如果等于为true 设置给总选框的属性，
        // 如果不等于，则是false
        let result = $('.j-checkbox').length === $('.j-checkbox:checked').length
        console.log(result);
        $('.checkall').prop('checked', result)
        totalNum()
        getBgc()
      })


      // 3,添加背景
      function getBgc() {
        // $('.j-checkbox').each(function (index, item) {
        //   if ($(item).prop('checked')) {
        //     $(item).parents('.cart-item').addClass('check-cart-item')
        //   } else {
        //     $(item).parents('.cart-item').removeClass('check-cart-item')
        //   }
        // })
        $('.j-checkbox').parents('.cart-item').removeClass('check-cart-item')
        $('.j-checkbox:checked').parents('.cart-item').addClass('check-cart-item')
      }




      // 4,加减功能，
      // 加
      $('.increment,.decrement,.itxt').on('click input', function (ev) {
        // console.log(22);
        // console.log($(this).siblings('.itxt');
        let theInput
        if (ev.type === 'click') {
          theInput = $(this).siblings('.itxt')
          if ($(this).html().trim() == '+') {
            theInput.val(theInput.val() * 1 + 1)
          } else if ($(this).html().trim() == '-' && theInput.val() > 1) {
            theInput.val(theInput.val() - 1)
          }
        } else if (ev.type === 'input') {
          // console.log( theInput);
          // console.log( $(this));
          theInput = $(this)
          if (theInput.val() < 1) {
            theInput.val(1)
          }
        }
        // $(this).prev().val($(this).prev().val() * 1 + 1)
        let price = $(this).parents('.cart-item').find('.p-price').text().substr(1)

        // console.log(theInput);
        // console.log($(this));
        if (theInput.length == 0) {
          theInput = $(this)
        }
        // // console.log(price);
        // let val = $(this).prev().val()
        let val = theInput.val()
        // // console.log(val);
        $(this).parents('.cart-item').find('.p-sum').text('￥' + (price * val).toFixed(2))
        // totalNum()
      })




      // 减号
      // $('.decrement').on('click', function () {
      //   // if ($(this).next().val($(this).next().val() - 1) === 1) {
      //   //   return 
      //   // }
      //   if ($(this).next().val() > 1) {
      //     $(this).next().val($(this).next().val() - 1)
      //   }

      //   let price = $(this).parents('.cart-item').find('.p-price').text().substr(1)
      //   // console.log(price);
      //   let val = $(this).next().val()
      //   // console.log(price*val);
      //   // console.log(val);
      //   // console.log(price * val);
      //   $(this).parents('.cart-item').find('.p-sum').text('￥' + (price * val).toFixed(2))
      //   totalNum()
      // })



      // input 框输入数字
      $('.itxt').on('input', function () {
        if ($(this).val() < 1) {
          $(this).val(1)
        }
        let val = $(this).val()
        let price = $(this).parents('.cart-item').find('.p-price').text().substr(1)
        $(this).parents('.cart-item').find('.p-sum').text('￥' + (price * val).toFixed(2))
        totalNum()
      })



      // 删除功能
      $('.p-action a').on('click', function () {
        // 删除整个父级元素
        $(this).parents('.cart-item').remove()
        del()
        // let result = Array.from($('.j-checkbox')).every((item, index) => {
        //   return $(item).prop('checked')
        // })
        // if ($('.j-checkbox').length === 0) {
        //   result = false
        // }
        // $('.checkall').prop('checked', result)
        totalNum()
      })

      function del() {
        let result = Array.from($('.j-checkbox')).every(function (item) {
          return $(item).prop('checked')
        })
        if ($('.j-checkbox').length === 0) {
          result = false
        }
        $('.checkall').prop('checked', result)
      }



      // 删除选中的商品
      $('.remove-batch').on('click', function () {
        $('.j-checkbox').each(function (index, item) {
          if ($(item).prop('checked')) {
            $(this).parents('.cart-item').remove()
          }
        })
        // del()
        let result = Array.from($('.j-checkbox')).every(function (item) {
          return $(item).prop('checked') === true
        })
        if ($('.j-checkbox').length === 0) {
          result = false
        }
        $('.checkall').prop('checked', result)
        totalNum()
      })


      // 清理购物车
      $('.clear-all').on('click', function () {
        $('.cart-item-list').empty()

        $('.checkall').prop('checked', false)
        totalNum()
      })

      // 数量统计
      function totalNum() {
        let sum = 0
        let totalPrice = 0
        $('.j-checkbox').each(function (index, item) {
          if ($(item).prop('checked')) {
            sum += $(item).parents('.cart-item').find('.itxt').val() * 1
            totalPrice += +$(item).parents('.cart-item').find('.p-sum').text().substr(1)
          }
        })
        // console.log(sum);
        $('.amount-sum em').text(sum)
        // console.log(totalPrice);
        $('.price-sum em').text('￥' + totalPrice)
      }
      // console.log(sum);


    })
  </script>
</body>

</html>